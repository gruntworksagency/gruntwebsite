---
import PrimaryCTA from "@components/ui/buttons/PrimaryCTA.astro";
import Container from "@components/ui/Container.astro";
import { Image } from "astro:assets";
import ReviewComponent from "@components/ui/blocks/ReviewComponent.astro";
// Removed all direct image/video imports

// Define props from Astro
const {
  withReview,
  avatars,
  starCount,
  rating,
  reviews,
  heatworksLogoSrc,
  cloud1MinSrc,
  cloud2MinSrc,
  cloud3MinSrc,
  ipadSrc,
  videoCompressed2Src,
  grassTransitionSrc,
  heroBackgroundSrc,
} = Astro.props;

// Define TypeScript interface for props
interface Props {
  withReview?: boolean;
  avatars?: Array<string>;
  starCount?: number;
  rating?: string;
  reviews?: string;
  heatworksLogoSrc: any;
  cloud1MinSrc: any;
  cloud2MinSrc: any;
  cloud3MinSrc: any;
  ipadSrc: any;
  videoCompressed2Src: string | { src: string };
  grassTransitionSrc: any;
  heroBackgroundSrc?: any;
}
---

<!-- 
  NOTE FOR USER: 
  The assets for this component (images and video) are now passed as props from the parent page.
-->
<section
  class="stormy-background relative flex min-h-screen flex-col justify-center overflow-hidden"
>
  <div
    class="clouds-layer pointer-events-none absolute top-0 left-0 z-10 h-[180px] w-full md:h-[220px] lg:h-[260px]"
  >
    <Image
      src={cloud3MinSrc}
      alt=""
      width={490}
      height={316}
      class="cloud-left absolute top-0 left-[-150px] h-[200px] w-auto lg:h-[300px]"
    />
    <Image
      src={cloud2MinSrc}
      alt=""
      width={998}
      height={239}
      class="cloud-center absolute top-[-20px] left-1/2 h-[200px] w-auto -translate-x-1/2 lg:h-[300px]"
    />
    <Image
      src={cloud1MinSrc}
      alt=""
      width={598}
      height={338}
      class="cloud-right absolute top-0 right-[-300px] h-[300px] w-auto lg:right-[-150px] lg:h-[400px]"
    />
  </div>
  <Container maxWidth="max-w-[--breakpoint-xl]">
    <!-- Main Content -->
    <div
      class="relative z-20 flex flex-col items-center pb-16 md:pb-24 lg:pb-32"
    >
      <!-- Text Content Container -->
      <div
        class="mx-auto flex flex-col items-center px-4 pt-[10rem] text-center"
      >
        <!-- Pill Text -->
        <div
          class="mb-6 inline-block rounded-full bg-white/80 px-4 py-2 text-sm font-bold text-[#2d2828] backdrop-blur-sm"
        >
          The Ultimate Local SEO Audit
        </div>

        <!-- Main Headline -->
        <h2
          class="mb-4 max-w-3xl text-5xl font-black text-balance text-[#2d2828] md:text-6xl"
        >
          Invisible on Google Maps? <br />
          <span class="pt-1 text-2xl font-bold">Stop Losing Jobs</span>
        </h2>

        <span class="m-[-10px] text-xs text-[#2d2828]">start with</span>

        <!-- HEATWORKS Logo -->
        <div class="my-4">
          <Image
            src={heatworksLogoSrc}
            alt="HEATWORKS Logo"
            width={300}
            height={120}
            class="mx-auto h-auto w-[250px]"
          />
        </div>

        <!-- Tagline -->
        <p
          class="text-md mt-4 mb-8 max-w-2xl text-center text-balance text-[#2d2828]"
        >
          <span class="font-bold">HEATWORKS</span> is more than just your ultimate
          <span class="font-medium">Google Local Home Services Audit</span>.
          <br />See your
          <i>actual rankings</i>
          across your
          <span class="font-medium">entire metro area</span>
          area. <br />Built for landscapers who hate guessing.
        </p>
        <!-- Review Section: This section presents avatars, review ratings and the number of reviews -->
        <div class="inline-block">
          {
            withReview ? (
              <ReviewComponent
                avatars={avatars}
                starCount={starCount}
                rating={rating}
                reviews={reviews}
              />
            ) : (
              ""
            )
          }
        </div>

        <!-- CTA Row -->
        <div
          class="z-10 mt-2 mb-8 flex flex-col items-center justify-center gap-4 sm:flex-row md:mt-8"
        >
          <!-- Price Badge -->
          <div
            class="flex flex-col items-center rounded-lg border-2 border-red-900 bg-white px-6 py-2 text-center shadow-md"
          >
            <span class="mb-[-5px] text-[9px] font-bold text-red-900">
              limited time
            </span>
            <div class="flex items-center gap-1">
              <span class="text-xl font-bold text-black">
                $75
                <span class="pl-1 text-[10px] text-gray-400">/ one-time</span>
              </span>
            </div>
          </div>

          <PrimaryCTA title="Start Audit" url="/audit" />
        </div>
      </div>

      <!-- iPad/Video Container -->
      <div
        class="relative z-20 mx-auto mt-0 hidden w-full max-w-[1280px] px-4 md:block"
      >
        <div class="relative mx-auto aspect-[16/9] w-full">
          <Image
            src={ipadSrc}
            alt="iPad mockup displaying Heatworks audit"
            width={1280}
            height={720}
            class="absolute inset-0 z-10 h-full w-full object-contain"
          />
          <!-- Video area (iPad screen) -->
          <div
            class="absolute top-[15.08%] left-[15.08%] z-[5] flex h-[69.84%] w-[69.84%] items-center justify-center"
            aria-label="iPad screen area"
          >
            <video
              src={typeof videoCompressed2Src === "string"
                ? videoCompressed2Src
                : videoCompressed2Src.src}
              autoplay
              muted
              loop
              playsinline
              class="h-full w-full rounded-[18px] object-cover shadow-lg"
              aria-label="Heatworks audit demo video"
            >
            </video>
          </div>
        </div>
      </div>
    </div>
  </Container>
  <!-- Grass Transition Image -->
  <div
    class="absolute bottom-[-7rem] left-0 z-[15] mb-0 w-full transform overflow-hidden sm:bottom-[-10rem] md:bottom-[-12rem] lg:bottom-[-16rem] xl:bottom-[-24rem]"
  >
    <img
      src={grassTransitionSrc}
      alt="Grass transition effect"
      width="1440"
      height="1035"
      class="h-auto w-full object-fill"
    />
  </div>
</section>

<style>
  .stormy-background {
    background:
      radial-gradient(
        ellipse at 50% 20%,
        rgba(250, 235, 215, 0.85),
        transparent 60%
      ),
      radial-gradient(ellipse at center, #9fcdfe, #161326 70%),
      linear-gradient(to top, #afdcfa, #142c61);
  }
  .clouds-layer {
    pointer-events: none;
  }
  @media (max-width: 767px) {
    .stormy-background {
      background:
        radial-gradient(
          ellipse 100% 65% at 50% 28%,
          rgba(250, 235, 215, 0.55),
          transparent 85%
        ),
        radial-gradient(ellipse at center, #9fcdfe, #161326 70%),
        linear-gradient(to top, #afdcfa, #142c61);
    }
  }
</style>
